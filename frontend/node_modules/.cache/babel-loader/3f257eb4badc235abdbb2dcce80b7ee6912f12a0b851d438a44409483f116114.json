{"ast":null,"code":"var _jsxFileName = \"/Users/ashishkumar/Desktop/Labs Co/Resume Projects/Smart Snapper/frontend/src/components/TakePhoto.js\",\n  _s = $RefreshSig$();\nimport { useContext } from 'react';\nimport React from 'react';\nimport { CartContext } from '../CartContext';\nimport Alert from './Alert';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst TakePhoto = () => {\n  _s();\n  const [alert, setAlert] = useState(false);\n  const {\n    formatDate,\n    formatTime,\n    user,\n    alt,\n    baseURL,\n    auth\n  } = useContext(CartContext);\n  const setALertTime = time => {\n    setTimeout(() => {\n      setAlert(false);\n    }, time);\n  };\n\n  // Navigator video stream\n  const handleClick = async () => {\n    try {\n      const stream = await navigator.mediaDevices.getUserMedia({\n        video: {\n          optional: [{\n            minWidth: 320\n          }, {\n            minWidth: 640\n          }, {\n            minWidth: 800\n          }, {\n            minWidth: 900\n          }, {\n            minWidth: 1024\n          }, {\n            minWidth: 1280\n          }, {\n            minWidth: 1920\n          }, {\n            minWidth: 2560\n          }]\n        },\n        audio: false\n      });\n      let video = document.querySelector(\".ssCtr\");\n      let takePhoto = document.querySelector('.take-ss');\n      let ssSave = document.querySelector('.ss-save');\n      let ssTracks = stream.getTracks();\n\n      // set video source\n      video.srcObject = stream;\n      takePhoto.style.display = \"none\";\n      ssSave.style.display = \"inline-block\";\n\n      // take a picture on K press\n      document.querySelector('.ss-save').addEventListener('click', async () => {\n        takePhoto.style.display = \"inline-block\";\n        ssSave.style.display = \"none\";\n        let canvas = document.createElement('canvas');\n        // set canvas width and height\n        canvas.width = 850;\n        canvas.height = 638;\n        // Draw a new image\n        canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);\n        // Take a shot\n        let img = canvas.toDataURL('image/jpeg');\n        // take the file name\n        let fileName = prompt(\"Enter file name\", \"my-image\");\n        let date = formatDate();\n        let time = formatTime();\n        let lat, long;\n        navigator.geolocation.getCurrentPosition(function (pos) {\n          console.log(pos.coords);\n          lat = pos.coords.latitude;\n          long = pos.coords.longitude;\n          let latitude = ['', lat.toString()];\n          let longitude = ['', long.toString()];\n          fetch(`${baseURL}/take-photo`, {\n            method: 'POST',\n            headers: {\n              \"Content-type\": \"application/json; charset=UTF-8\"\n            },\n            body: JSON.stringify({\n              img,\n              filename: fileName,\n              date,\n              time,\n              latitude,\n              longitude,\n              altitude: alt,\n              alias: auth.user.alias,\n              ip: user.ip,\n              iptype: user.iptype,\n              searchname: user.name,\n              searchtype: user.type,\n              searchversion: user.version,\n              devicebrand: user.device.brand,\n              devicetype: user.device.type,\n              devicename: user.device.name,\n              osname: user.os.name,\n              ostype: user.os.type\n            })\n          }).then(response => response.json()).then(data => {\n            console.log(data);\n            setAlert(true);\n            setALertTime(200);\n          });\n        });\n        ssTracks.forEach(track => {\n          track.stop();\n        });\n        video.srcObject = null;\n      });\n    } catch (err) {\n      console.log(err);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"ss-sec\",\n    children: [alert ? /*#__PURE__*/_jsxDEV(Alert, {\n      text: \"File Saved\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 22\n    }, this) : \"\", /*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Take Photo\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"video\", {\n        autoPlay: true,\n        className: \"ssCtr\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"take-ss\",\n        onClick: handleClick,\n        children: \"Start\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"ss-save\",\n        style: {\n          display: \"none\"\n        },\n        children: \"Click\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 115,\n    columnNumber: 9\n  }, this);\n};\n_s(TakePhoto, \"hK4tZf33EsYuZzXJ9SW60Zz/krE=\");\n_c = TakePhoto;\nexport default TakePhoto;\nvar _c;\n$RefreshReg$(_c, \"TakePhoto\");","map":{"version":3,"names":["useContext","React","CartContext","Alert","jsxDEV","_jsxDEV","TakePhoto","_s","alert","setAlert","useState","formatDate","formatTime","user","alt","baseURL","auth","setALertTime","time","setTimeout","handleClick","stream","navigator","mediaDevices","getUserMedia","video","optional","minWidth","audio","document","querySelector","takePhoto","ssSave","ssTracks","getTracks","srcObject","style","display","addEventListener","canvas","createElement","width","height","getContext","drawImage","img","toDataURL","fileName","prompt","date","lat","long","geolocation","getCurrentPosition","pos","console","log","coords","latitude","longitude","toString","fetch","method","headers","body","JSON","stringify","filename","altitude","alias","ip","iptype","searchname","name","searchtype","type","searchversion","version","devicebrand","device","brand","devicetype","devicename","osname","os","ostype","then","response","json","data","forEach","track","stop","err","className","children","text","_jsxFileName","lineNumber","columnNumber","autoPlay","onClick","_c","$RefreshReg$"],"sources":["/Users/ashishkumar/Desktop/Labs Co/Resume Projects/Smart Snapper/frontend/src/components/TakePhoto.js"],"sourcesContent":["import { useContext } from 'react';\r\nimport React from 'react'\r\nimport { CartContext } from '../CartContext';\r\nimport Alert from './Alert';\r\n\r\nconst TakePhoto = () => {\r\n    const [alert, setAlert] = useState(false);\r\n    const { formatDate, formatTime, user, alt, baseURL, auth } = useContext(CartContext);\r\n\r\n\r\n    const setALertTime = (time) => {\r\n        setTimeout(() => {\r\n            setAlert(false);\r\n        }, time);\r\n    }\r\n\r\n    // Navigator video stream\r\n    const handleClick = async () => {\r\n        try {\r\n\r\n            const stream = await navigator.mediaDevices.\r\n                getUserMedia({\r\n                    video: {\r\n                        optional: [\r\n                            { minWidth: 320 },\r\n                            { minWidth: 640 },\r\n                            { minWidth: 800 },\r\n                            { minWidth: 900 },\r\n                            { minWidth: 1024 },\r\n                            { minWidth: 1280 },\r\n                            { minWidth: 1920 },\r\n                            { minWidth: 2560 }\r\n                        ]\r\n                    },\r\n                    audio: false\r\n                });\r\n\r\n            let video = document.querySelector(\".ssCtr\");\r\n            let takePhoto = document.querySelector('.take-ss');\r\n            let ssSave = document.querySelector('.ss-save');\r\n\r\n            let ssTracks = stream.getTracks();\r\n\r\n            // set video source\r\n            video.srcObject = stream;\r\n            takePhoto.style.display = \"none\";\r\n            ssSave.style.display = \"inline-block\";\r\n\r\n            // take a picture on K press\r\n            document.querySelector('.ss-save').addEventListener('click', async () => {\r\n                takePhoto.style.display = \"inline-block\";\r\n                ssSave.style.display = \"none\";\r\n                let canvas = document.createElement('canvas');\r\n                // set canvas width and height\r\n                canvas.width = 850;\r\n                canvas.height = 638;\r\n                // Draw a new image\r\n                canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);\r\n                // Take a shot\r\n                let img = canvas.toDataURL('image/jpeg');\r\n                // take the file name\r\n                let fileName = prompt(\"Enter file name\", \"my-image\");\r\n\r\n                let date = formatDate();\r\n                let time = formatTime();\r\n                let lat, long;\r\n\r\n                navigator.geolocation.getCurrentPosition(function (pos) {\r\n                    console.log(pos.coords)\r\n                    lat = pos.coords.latitude;\r\n                    long = pos.coords.longitude;\r\n\r\n                    let latitude = ['', lat.toString()];\r\n                    let longitude = ['', long.toString()];\r\n\r\n                    fetch(`${baseURL}/take-photo`, {\r\n                        method: 'POST',\r\n                        headers: {\r\n                            \"Content-type\": \"application/json; charset=UTF-8\"\r\n                        },\r\n                        body: JSON.stringify({\r\n                            img, filename: fileName, date, time, latitude, longitude, altitude: alt, alias: auth.user.alias,\r\n                            ip: user.ip,\r\n                            iptype: user.iptype,\r\n                            searchname: user.name,\r\n                            searchtype: user.type,\r\n                            searchversion: user.version,\r\n                            devicebrand: user.device.brand,\r\n                            devicetype: user.device.type,\r\n                            devicename: user.device.name,\r\n                            osname: user.os.name,\r\n                            ostype: user.os.type,\r\n                        })\r\n                    }).then((response) => response.json())\r\n                        .then((data) => {\r\n                            console.log(data);\r\n                            setAlert(true);\r\n                            setALertTime(200);\r\n                        });\r\n                });\r\n\r\n                ssTracks.forEach((track) => {\r\n                    track.stop();\r\n                });\r\n                video.srcObject = null;\r\n            })\r\n\r\n        } catch (err) {\r\n            console.log(err);\r\n        }\r\n    }\r\n\r\n\r\n    return (\r\n        <div className=\"ss-sec\">\r\n            {alert ? <Alert text=\"File Saved\" /> : \"\"}\r\n            <h3>Take Photo</h3>\r\n            <div>\r\n                <video autoPlay className=\"ssCtr\"></video>\r\n            </div>\r\n            <div>\r\n                <button className=\"take-ss\" onClick={handleClick}>Start</button>\r\n                <button className=\"ss-save\" style={{ display: \"none\" }}>Click</button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default TakePhoto"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}