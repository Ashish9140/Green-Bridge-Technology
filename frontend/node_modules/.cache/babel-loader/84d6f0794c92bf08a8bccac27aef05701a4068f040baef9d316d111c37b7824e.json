{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ashishkumar/Desktop/Labs Co/Resume Projects/Smart Snapper/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/ashishkumar/Desktop/Labs Co/Resume Projects/Smart Snapper/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import{useContext}from'react';import React from'react';import{CartContext}from'../CartContext';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var TakePhoto=function TakePhoto(){var _useContext=useContext(CartContext),formatDate=_useContext.formatDate,formatTime=_useContext.formatTime,user=_useContext.user,alt=_useContext.alt,baseURL=_useContext.baseURL,auth=_useContext.auth;// Navigator video stream\nvar handleClick=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var stream,video,takePhoto,ssSave,ssTracks;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return navigator.mediaDevices.getUserMedia({video:{optional:[{minWidth:320},{minWidth:640},{minWidth:800},{minWidth:900},{minWidth:1024},{minWidth:1280},{minWidth:1920},{minWidth:2560}]},audio:false});case 3:stream=_context2.sent;video=document.querySelector(\".ssCtr\");takePhoto=document.querySelector('.take-ss');ssSave=document.querySelector('.ss-save');ssTracks=stream.getTracks();// set video source\nvideo.srcObject=stream;takePhoto.style.display=\"none\";ssSave.style.display=\"inline-block\";// take a picture on K press\ndocument.querySelector('.ss-save').addEventListener('click',/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var canvas,img,fileName,date,time,lat,long;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:takePhoto.style.display=\"inline-block\";ssSave.style.display=\"none\";canvas=document.createElement('canvas');// set canvas width and height\ncanvas.width=850;canvas.height=638;// Draw a new image\ncanvas.getContext('2d').drawImage(video,0,0,canvas.width,canvas.height);// Take a shot\nimg=canvas.toDataURL('image/jpeg');// take the file name\nfileName=prompt(\"Enter file name\",\"my-image\");date=formatDate();time=formatTime();navigator.geolocation.getCurrentPosition(function(pos){console.log(pos.coords);lat=pos.coords.latitude;long=pos.coords.longitude;var latitude=['',lat.toString()];var longitude=['',long.toString()];fetch(\"\".concat(baseURL,\"/take-photo\"),{method:'POST',headers:{\"Content-type\":\"application/json; charset=UTF-8\"},body:JSON.stringify({img:img,filename:fileName,date:date,time:time,latitude:latitude,longitude:longitude,altitude:alt,alias:auth.user.alias,ip:user.ip,iptype:user.iptype,searchname:user.name,searchtype:user.type,searchversion:user.version,devicebrand:user.device.brand,devicetype:user.device.type,devicename:user.device.name,osname:user.os.name,ostype:user.os.type})}).then(function(response){return response.json();}).then(function(data){return console.log(data);});});ssTracks.forEach(function(track){track.stop();});video.srcObject=null;case 13:case\"end\":return _context.stop();}},_callee);})));_context2.next=17;break;case 14:_context2.prev=14;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 17:case\"end\":return _context2.stop();}},_callee2,null,[[0,14]]);}));return function handleClick(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"ss-sec\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Take Photo\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"video\",{autoPlay:true,className:\"ssCtr\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"take-ss\",onClick:handleClick,children:\"Start\"}),/*#__PURE__*/_jsx(\"button\",{className:\"ss-save\",style:{display:\"none\"},children:\"Click\"})]})]});};export default TakePhoto;","map":{"version":3,"names":["useContext","React","CartContext","jsx","_jsx","jsxs","_jsxs","TakePhoto","_useContext","formatDate","formatTime","user","alt","baseURL","auth","handleClick","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","stream","video","takePhoto","ssSave","ssTracks","wrap","_callee2$","_context2","prev","next","navigator","mediaDevices","getUserMedia","optional","minWidth","audio","sent","document","querySelector","getTracks","srcObject","style","display","addEventListener","_callee","canvas","img","fileName","date","time","lat","long","_callee$","_context","createElement","width","height","getContext","drawImage","toDataURL","prompt","geolocation","getCurrentPosition","pos","console","log","coords","latitude","longitude","toString","fetch","concat","method","headers","body","JSON","stringify","filename","altitude","alias","ip","iptype","searchname","name","searchtype","type","searchversion","version","devicebrand","device","brand","devicetype","devicename","osname","os","ostype","then","response","json","data","forEach","track","stop","t0","apply","arguments","className","children","autoPlay","onClick"],"sources":["/Users/ashishkumar/Desktop/Labs Co/Resume Projects/Smart Snapper/frontend/src/components/TakePhoto.js"],"sourcesContent":["import { useContext } from 'react';\r\nimport React from 'react'\r\nimport { CartContext } from '../CartContext';\r\n\r\nconst TakePhoto = () => {\r\n\r\n    const { formatDate, formatTime, user, alt, baseURL, auth } = useContext(CartContext);\r\n\r\n    // Navigator video stream\r\n    const handleClick = async () => {\r\n        try {\r\n\r\n            const stream = await navigator.mediaDevices.\r\n                getUserMedia({\r\n                    video: {\r\n                        optional: [\r\n                            { minWidth: 320 },\r\n                            { minWidth: 640 },\r\n                            { minWidth: 800 },\r\n                            { minWidth: 900 },\r\n                            { minWidth: 1024 },\r\n                            { minWidth: 1280 },\r\n                            { minWidth: 1920 },\r\n                            { minWidth: 2560 }\r\n                        ]\r\n                    },\r\n                    audio: false\r\n                });\r\n\r\n            let video = document.querySelector(\".ssCtr\");\r\n            let takePhoto = document.querySelector('.take-ss');\r\n            let ssSave = document.querySelector('.ss-save');\r\n\r\n            let ssTracks = stream.getTracks();\r\n\r\n            // set video source\r\n            video.srcObject = stream;\r\n            takePhoto.style.display = \"none\";\r\n            ssSave.style.display = \"inline-block\";\r\n\r\n            // take a picture on K press\r\n            document.querySelector('.ss-save').addEventListener('click', async () => {\r\n                takePhoto.style.display = \"inline-block\";\r\n                ssSave.style.display = \"none\";\r\n                let canvas = document.createElement('canvas');\r\n                // set canvas width and height\r\n                canvas.width = 850;\r\n                canvas.height = 638;\r\n                // Draw a new image\r\n                canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);\r\n                // Take a shot\r\n                let img = canvas.toDataURL('image/jpeg');\r\n                // take the file name\r\n                let fileName = prompt(\"Enter file name\", \"my-image\");\r\n\r\n                let date = formatDate();\r\n                let time = formatTime();\r\n                let lat, long;\r\n\r\n                navigator.geolocation.getCurrentPosition(function (pos) {\r\n                    console.log(pos.coords)\r\n                    lat = pos.coords.latitude;\r\n                    long = pos.coords.longitude;\r\n\r\n                    let latitude = ['', lat.toString()];\r\n                    let longitude = ['', long.toString()];\r\n\r\n                    fetch(`${baseURL}/take-photo`, {\r\n                        method: 'POST',\r\n                        headers: {\r\n                            \"Content-type\": \"application/json; charset=UTF-8\"\r\n                        },\r\n                        body: JSON.stringify({\r\n                            img, filename: fileName, date, time, latitude, longitude, altitude: alt, alias: auth.user.alias,\r\n                            ip: user.ip,\r\n                            iptype: user.iptype,\r\n                            searchname: user.name,\r\n                            searchtype: user.type,\r\n                            searchversion: user.version,\r\n                            devicebrand: user.device.brand,\r\n                            devicetype: user.device.type,\r\n                            devicename: user.device.name,\r\n                            osname: user.os.name,\r\n                            ostype: user.os.type,\r\n                        })\r\n                    }).then((response) => response.json())\r\n                        .then((data) => console.log(data));\r\n                });\r\n\r\n                ssTracks.forEach((track) => {\r\n                    track.stop();\r\n                });\r\n                video.srcObject = null;\r\n            })\r\n\r\n        } catch (err) {\r\n            console.log(err);\r\n        }\r\n    }\r\n\r\n\r\n    return (\r\n        <div className=\"ss-sec\">\r\n            <h3>Take Photo</h3>\r\n            <div>\r\n                <video autoPlay className=\"ssCtr\"></video>\r\n            </div>\r\n            <div>\r\n                <button className=\"take-ss\" onClick={handleClick}>Start</button>\r\n                <button className=\"ss-save\" style={{ display: \"none\" }}>Click</button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default TakePhoto"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}