{"ast":null,"code":"import _regeneratorRuntime from\"/Users/ashishkumar/Desktop/Labs Co/Resume Projects/Smart Snapper/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/ashishkumar/Desktop/Labs Co/Resume Projects/Smart Snapper/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/ashishkumar/Desktop/Labs Co/Resume Projects/Smart Snapper/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useContext,useState}from'react';import React from'react';import{CartContext}from'../CartContext';import Alert from'./Alert';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var TakePhoto=function TakePhoto(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),alert=_useState2[0],setAlert=_useState2[1];var _useContext=useContext(CartContext),formatDate=_useContext.formatDate,formatTime=_useContext.formatTime,user=_useContext.user,baseURL=_useContext.baseURL,auth=_useContext.auth,alt=_useContext.alt;var setAlertTime=function setAlertTime(time){setTimeout(function(){setAlert(false);},time);};// Navigator video stream\nvar handleClick=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(){var stream,video,takePhoto,ssSave,ssTracks;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return navigator.mediaDevices.getUserMedia({video:{optional:[{minWidth:320},{minWidth:640},{minWidth:800},{minWidth:900},{minWidth:1024},{minWidth:1280},{minWidth:1920},{minWidth:2560}]},audio:false});case 3:stream=_context2.sent;video=document.querySelector(\".ssCtr\");takePhoto=document.querySelector('.take-ss');ssSave=document.querySelector('.ss-save');ssTracks=stream.getTracks();// set video source\nvideo.srcObject=stream;takePhoto.style.display=\"none\";ssSave.style.display=\"inline-block\";// take a picture on K press\ndocument.querySelector('.ss-save').addEventListener('click',/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var canvas,img,fileName,date,time,lat,long;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:takePhoto.style.display=\"inline-block\";ssSave.style.display=\"none\";canvas=document.createElement('canvas');// set canvas width and height\ncanvas.width=850;canvas.height=638;// Draw a new image\ncanvas.getContext('2d').drawImage(video,0,0,canvas.width,canvas.height);// Take a shot\nimg=canvas.toDataURL('image/jpeg');// take the file name\nfileName=prompt(\"Enter file name\",\"my-image\");date=formatDate();time=formatTime();navigator.geolocation.getCurrentPosition(function(pos){console.log(pos.coords);lat=pos.coords.latitude;long=pos.coords.longitude;var latitude=['',lat.toString()];var longitude=['',long.toString()];fetch(\"\".concat(baseURL,\"/take-photo\"),{method:'POST',headers:{\"Content-type\":\"application/json; charset=UTF-8\"},body:JSON.stringify({img:img,filename:fileName,date:date,time:time,latitude:latitude,longitude:longitude,altitude:alt,alias:auth.user.alias,ip:user.ip,iptype:user.iptype,searchname:user.name,searchtype:user.type,searchversion:user.version,devicebrand:user.device.brand,devicetype:user.device.type,devicename:user.device.name,osname:user.os.name,ostype:user.os.type})}).then(function(response){return response.json();}).then(function(data){console.log(data);setAlert(true);setAlertTime(2000);});});ssTracks.forEach(function(track){track.stop();});video.srcObject=null;case 13:case\"end\":return _context.stop();}},_callee);})));_context2.next=17;break;case 14:_context2.prev=14;_context2.t0=_context2[\"catch\"](0);console.log(_context2.t0);case 17:case\"end\":return _context2.stop();}},_callee2,null,[[0,14]]);}));return function handleClick(){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"ss-sec\",children:[alert?/*#__PURE__*/_jsx(Alert,{text:\"File Saved\"}):\"\",/*#__PURE__*/_jsx(\"h3\",{children:\"Take Photo\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"video\",{autoPlay:true,className:\"ssCtr\"})}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"take-ss\",onClick:handleClick,children:\"Start\"}),/*#__PURE__*/_jsx(\"button\",{className:\"ss-save\",style:{display:\"none\"},children:\"Click\"})]})]});};export default TakePhoto;","map":{"version":3,"names":["useContext","useState","React","CartContext","Alert","jsx","_jsx","jsxs","_jsxs","TakePhoto","_useState","_useState2","_slicedToArray","alert","setAlert","_useContext","formatDate","formatTime","user","baseURL","auth","alt","setAlertTime","time","setTimeout","handleClick","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","stream","video","takePhoto","ssSave","ssTracks","wrap","_callee2$","_context2","prev","next","navigator","mediaDevices","getUserMedia","optional","minWidth","audio","sent","document","querySelector","getTracks","srcObject","style","display","addEventListener","_callee","canvas","img","fileName","date","lat","long","_callee$","_context","createElement","width","height","getContext","drawImage","toDataURL","prompt","geolocation","getCurrentPosition","pos","console","log","coords","latitude","longitude","toString","fetch","concat","method","headers","body","JSON","stringify","filename","altitude","alias","ip","iptype","searchname","name","searchtype","type","searchversion","version","devicebrand","device","brand","devicetype","devicename","osname","os","ostype","then","response","json","data","forEach","track","stop","t0","apply","arguments","className","children","text","autoPlay","onClick"],"sources":["/Users/ashishkumar/Desktop/Labs Co/Resume Projects/Smart Snapper/frontend/src/components/TakePhoto.js"],"sourcesContent":["import { useContext,useState } from 'react';\r\nimport React from 'react'\r\nimport { CartContext } from '../CartContext';\r\nimport Alert from './Alert';\r\n\r\nconst TakePhoto = () => {\r\n    const [alert, setAlert] = useState(false);\r\n    const { formatDate, formatTime, user, baseURL, auth, alt} = useContext(CartContext);\r\n\r\n    const setAlertTime = (time) => {\r\n        setTimeout(() => {\r\n            setAlert(false);\r\n        }, time);\r\n    }\r\n    // Navigator video stream\r\n    const handleClick = async () => {\r\n        try {\r\n\r\n            const stream = await navigator.mediaDevices.\r\n                getUserMedia({\r\n                    video: {\r\n                        optional: [\r\n                            { minWidth: 320 },\r\n                            { minWidth: 640 },\r\n                            { minWidth: 800 },\r\n                            { minWidth: 900 },\r\n                            { minWidth: 1024 },\r\n                            { minWidth: 1280 },\r\n                            { minWidth: 1920 },\r\n                            { minWidth: 2560 }\r\n                        ]\r\n                    },\r\n                    audio: false\r\n                });\r\n\r\n            let video = document.querySelector(\".ssCtr\");\r\n            let takePhoto = document.querySelector('.take-ss');\r\n            let ssSave = document.querySelector('.ss-save');\r\n\r\n            let ssTracks = stream.getTracks();\r\n\r\n            // set video source\r\n            video.srcObject = stream;\r\n            takePhoto.style.display = \"none\";\r\n            ssSave.style.display = \"inline-block\";\r\n\r\n            // take a picture on K press\r\n            document.querySelector('.ss-save').addEventListener('click', async () => {\r\n                takePhoto.style.display = \"inline-block\";\r\n                ssSave.style.display = \"none\";\r\n                let canvas = document.createElement('canvas');\r\n                // set canvas width and height\r\n                canvas.width = 850;\r\n                canvas.height = 638;\r\n                // Draw a new image\r\n                canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);\r\n                // Take a shot\r\n                let img = canvas.toDataURL('image/jpeg');\r\n                // take the file name\r\n                let fileName = prompt(\"Enter file name\", \"my-image\");\r\n\r\n                let date = formatDate();\r\n                let time = formatTime();\r\n                let lat, long;\r\n\r\n                navigator.geolocation.getCurrentPosition(function (pos) {\r\n                    console.log(pos.coords)\r\n                    lat = pos.coords.latitude;\r\n                    long = pos.coords.longitude;\r\n\r\n                    let latitude = ['', lat.toString()];\r\n                    let longitude = ['', long.toString()];\r\n\r\n                    fetch(`${baseURL}/take-photo`, {\r\n                        method: 'POST',\r\n                        headers: {\r\n                            \"Content-type\": \"application/json; charset=UTF-8\"\r\n                        },\r\n                        body: JSON.stringify({\r\n                            img, filename: fileName, date, time, latitude, longitude, altitude: alt, alias: auth.user.alias,\r\n                            ip: user.ip,\r\n                            iptype: user.iptype,\r\n                            searchname: user.name,\r\n                            searchtype: user.type,\r\n                            searchversion: user.version,\r\n                            devicebrand: user.device.brand,\r\n                            devicetype: user.device.type,\r\n                            devicename: user.device.name,\r\n                            osname: user.os.name,\r\n                            ostype: user.os.type,\r\n                        })\r\n                    }).then((response) => response.json())\r\n                        .then((data) => {\r\n                            console.log(data);\r\n                            setAlert(true);\r\n                            setAlertTime(2000);\r\n                        });\r\n                });\r\n\r\n                ssTracks.forEach((track) => {\r\n                    track.stop();\r\n                });\r\n                video.srcObject = null;\r\n            })\r\n\r\n        } catch (err) {\r\n            console.log(err);\r\n        }\r\n    }\r\n\r\n\r\n    return (\r\n        <div className=\"ss-sec\">\r\n            {alert ? <Alert text=\"File Saved\" /> : \"\"}\r\n            <h3>Take Photo</h3>\r\n            <div>\r\n                <video autoPlay className=\"ssCtr\"></video>\r\n            </div>\r\n            <div>\r\n                <button className=\"take-ss\" onClick={handleClick}>Start</button>\r\n                <button className=\"ss-save\" style={{ display: \"none\" }}>Click</button>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default TakePhoto"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}